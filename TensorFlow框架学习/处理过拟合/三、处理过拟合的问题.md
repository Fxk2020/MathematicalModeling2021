# 三、处理过拟合的问题

## 1.过拟合和欠拟合

过拟合是指在验证数据上模型的准确性将达到峰值，**然后停滞或开始下降**。

*过度拟合*训练数据。学习如何应对过度拟合非常重要。尽管通常可以在*训练集*上达到高精度，但是我们真正想要的是开发能够很好地推广到*测试集*（或之前未见的数据）的模型。

如下图：

![Figure_1](C:\Users\26292\Desktop\美赛冲冲冲\2021Mathematical modeling\MathematicalModeling2021\TensorFlow框架学习\处理过拟合\Figure_1.png)

欠拟合是指模型仍有改进空间，如果模型不够强大，模型过于规范化，或者仅仅是没有经过足够长时间的训练。

而在机器学习过程中经常面对和需要解决的是过拟合问题。



## 2.如何处理过拟合

### 2.1处理过拟合的理论：

1. 正则化
2. 提前停止(Early stopping)
3. 获取更多的训练集
4. 选用合适的模型

### 2.2 TensorFlow中的方法

为了防止过度拟合，最好的解决方案是使用更完整的训练数据。数据集应涵盖模型应处理的所有输入范围。仅当涉及新的有趣案例时，其他数据才有用。

经过更完整数据训练的模型自然会更好地推广。当这不再可能时，下一个最佳解决方案是使用正则化之类的技术。这些因素限制了模型可以存储的信息的数量和类型。如果网络只能存储少量模式，那么优化过程将迫使它专注于最突出的模式，这些模式具有更好的泛化性。

但是在现实生活中通常无法将所有的数据都收集起来做为训练集，这样的话模型就没有了预测的意义。所以本文着重介绍一下正则化的技术：

#### The Higgs Dataset为例

引入包：

```python
import tensorflow as tf

from tensorflow.keras import layers
from tensorflow.keras import regularizers

#Anaconda指令 pip install git+https://github.com/tensorflow/docs.git

import tensorflow_docs as tfdocs
import tensorflow_docs.modeling
import tensorflow_docs.plots
```

```python 
from  IPython import display
from matplotlib import pyplot as plt

import numpy as np

import pathlib
import shutil
import tempfile
```

[`pathlib`](https://docs.python.org/zh-cn/3/library/pathlib.html#module-pathlib) --- 面向对象的文件系统路径

该模块提供表示文件系统路径的类，其语义适用于不同的操作系统。路径类被分为提供纯计算操作而没有 I/O 的 [纯路径](https://docs.python.org/zh-cn/3/library/pathlib.html#pure-paths)，以及从纯路径继承而来但提供 I/O 操作的 [具体路径](https://docs.python.org/zh-cn/3/library/pathlib.html#concrete-paths)。

[`shutil`](https://docs.python.org/zh-cn/3/library/shutil.html#module-shutil) --- 高阶文件操作

[`shutil`](https://docs.python.org/zh-cn/3/library/shutil.html#module-shutil) 模块提供了一系列对文件和文件集合的高阶操作。 特别是提供了一些支持文件拷贝和删除的函数。

temfile --- 临时文件操作

临时文件来存储数据，但不需要同其他程序共享，那么用TemporaryFile函数创建临时文件是最好的选择。其他的应用程序是无法找到或打开这个文件的，因为它并没有引用文件系统表。用这个函数创建的临时文件，关闭后会自动删除。