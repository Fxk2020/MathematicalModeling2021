## 主成分分析法（PCA）

### 1.基本原理

主成分分析（Principal Component Analysis，PCA）， 是一种[统计方法](https://baike.baidu.com/item/统计方法/10694433)。通过正交变换将一组可能存在相关性的变量转换为一组线性不相关的变量，转换后的这组变量叫主成分。

主成分分析作为基础的数学分析方法，其实际应用十分广泛，比如[人口统计学](https://baike.baidu.com/item/人口统计学)、[数量地理学](https://baike.baidu.com/item/数量地理学)、[分子动力学](https://baike.baidu.com/item/分子动力学)模拟、[数学建模](https://baike.baidu.com/item/数学建模/527)、数理分析等学科中均有应用，是一种常用的多变量分析方法。

主成分分析是设法将原来众多具有一定相关性（比如P个指标），重新组合成一组新的互相无关的[综合指标](https://baike.baidu.com/item/综合指标)来代替原来的指标。

主成分分析，是考察多个变量间相关性一种多元统计方法，研究如何通过少数几个主成分来揭示多个变量间的内部结构，即从原始变量中导出少数几个主成分，使它们尽可能多地保留原始变量的信息，且彼此间互不相关.通常数学上的处理就是将原来P个指标作[线性组合](https://baike.baidu.com/item/线性组合)，作为新的综合指标。

### 2.数学公式

![image-20210201212518765](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201212518765.png)

其中a1i, a2i, ……,api(i=1,……,m)为X的协[方差](https://baike.baidu.com/item/方差)阵Σ的[特征值](https://baike.baidu.com/item/特征值)所对应的特征向量，ZX1, ZX2, ……, ZXp是原始变量经过标准化处理的值，因为在实际应用中，往往存在指标的量纲不同，所以在计算之前须先消除量纲的影响，而将原始[数据标准化](https://baike.baidu.com/item/数据标准化)，本文所采用的数据就存在量纲影响

### 3.在spss中的使用

![image-20210201211842613](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201211842613.png)

提取了两个主成分，还有每个主成分的特征值；

![image-20210201212559667](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201212559667.png)

显示提取不同数量的主成分，每个主成分的特征值；

![image-20210201212329873](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201212329873.png)

成分矩阵中的数据除以主成分相对应的特征值开平方根便得到两个主成分中每个指标所对应的系数。

| 0.949  | 7.220 | 0.353164 |
| ------ | ----- | -------- |
| 0.112  |       | 0.041632 |
| -0.109 |       | -0.04065 |
| 0.978  |       | 0.364085 |
| 0.986  |       | 0.367041 |
| 0.983  |       | 0.36568  |
| 0.947  |       | 0.352325 |
| 0.977  |       | 0.363509 |
| 0.800  |       | 0.297613 |
| 0.954  |       | 0.355121 |

最后得到两个主成分：

F1=0.353ZX1 +0.042ZX2-0.041ZX3 +0.364ZX4 +0.367ZX5 +0.366ZX6 +0.352ZX7 +0.364ZX8 +0.298ZX9+0.355ZX10
F2 =0.175ZX1 -0.741ZX2+0.609ZX3 -0.004ZX4+0.063ZX5-0.061ZX6 -0.022ZX7 +0.158ZX8 -0.046ZX9 -0.115ZX10
F=(72.2/84.5) F1+(12.3/84.5) F2

**SPSS中自动进行了归一化：**

![image-20210201213933902](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201213933902.png)

归一化的值：

![image-20210201215700923](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201215700923.png)

![image-20210201214016348](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210201214016348.png)



计算得到主成分计算后的值：

| F1       | F2       | F        |
| -------- | -------- | -------- |
| -1.24422 | 1.959505 | -0.77788 |
| 1.962249 | 0.499743 | 1.749364 |
| -1.35315 | 0.408539 | -1.09671 |
| -3.04165 | -1.00843 | -2.74569 |
| 2.254176 | 0.234189 | 1.960142 |
| 0.297782 | -2.35615 | -0.08853 |
| 1.160592 | -0.19342 | 0.963499 |
| -1.9744  | -0.06632 | -1.69666 |
| 5.225846 | 0.113782 | 4.481723 |
| -3.28723 | 0.408562 | -2.74926 |

根据最后的值进行排序：

| 广东 | 4.481723 |
| ---- | -------- |
| 江苏 | 1.960142 |
| 山东 | 1.749364 |
| 浙江 | 0.963499 |
| 上海 | -0.08853 |
| 辽宁 | -0.77788 |
| 河北 | -1.09671 |
| 福建 | -1.69666 |
| 天津 | -2.74569 |
| 广西 | -2.74926 |

#### 4.实践--基于主成分分析法和AHP-GEM 模型的区域新增建设用地指标合理配置

#### 4.1背景

```python
	影响区域土地利用、建设用地指标配置的因素有很多, 如地区的人口状况、经济发展速度、产业政策和发展状况、资源状况等等。考虑到数据的可获得性和指标体系的完备性、层次性, 初步从人口、资源、经济、社会等方面选取了13 项指标, 分别是: 总人口、非农业人口、土地总面积、工业增加值、固定资产投资额、房地产开发投资额、人均地区生产总值、人均地方财政收入、实际利用外资、社会消费品零售总额、城镇居民人均可支配收入、地均GDP 即单位用地产出值、人均住房面积。
```
![image-20210202165456640](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202165456640.png)

#### 4.2计算主成分

这是13个变量的相关系数：

![image-20210202172103517](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202172103517.png)

提取过程中选取特征值大于0.8的，所以提取出3个主成分：

![image-20210202172206766](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202172206766.png)

根据成分矩阵和特征值计算主成分与原来变量的关系（**成分矩阵/主成分的特征值的开方**）：

![image-20210202172249438](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202172249438.png)

| 关系     |          |          |      | 系数        |              |              |
| -------- | -------- | -------- | ---- | ----------- | ------------ | ------------ |
| -0.0288  | 0.905926 | 0.236665 |      | -0.00989257 | 0.564552509  | 0.261512308  |
| 0.699183 | 0.63538  | -0.30959 |      | 0.240128651 | 0.395954141  | -0.342094525 |
| -0.29603 | 0.850767 | 0.314195 |      | -0.1016689  | 0.530178456  | 0.347181944  |
| 0.898133 | -0.0358  | 0.358268 |      | 0.308456564 | -0.022309933 | 0.395882115  |
| 0.984312 | 0.103698 | -0.01088 |      | 0.338053986 | 0.064622469  | -0.012021595 |
| 0.960023 | 0.047062 | 0.051563 |      | 0.329712165 | 0.029327712  | 0.056976638  |
| 0.932925 | -0.28846 | 0.186767 |      | 0.320405519 | -0.179764653 | 0.206375209  |
| 0.969053 | -0.20887 | 0.066215 |      | 0.332813258 | -0.130163612 | 0.073167121  |
| 0.734781 | 0.256051 | -0.60518 |      | 0.252354702 | 0.159565019  | -0.66871917  |
| 0.963839 | 0.162059 | -0.06157 |      | 0.331022672 | 0.100991693  | -0.068039024 |
| 0.931655 | -0.14834 | 0.092114 |      | 0.319969415 | -0.092442858 | 0.10178539   |
| 0.922618 | -0.28337 | 0.136413 |      | 0.316865534 | -0.176590311 | 0.150734676  |
| -0.4544  | -0.54012 | -0.02127 |      | -0.15605944 | -0.336590788 | -0.02350553  |

主成分

![image-20210202193032673](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202193032673.png)

F2，F3同理

![image-20210202193558630](C:\Users\26292\AppData\Roaming\Typora\typora-user-images\image-20210202193558630.png)

0.714  0.217  0.067

#### 4.3根据归一化后的值和主成分公式进行排序

归一化后的值

| Z总人口  | Z非农业人口 | Z土地总面积 | Z工业增加值 | Z固定资产投资额 | Z房地产开发投资额 | Z人均国内生产总值 | Z人均地方财政收入 | Z实际利用外资 | Z社会消费品零售总额 | Z城镇居民人均可支配 | Z地均GDP | Z人均住房面积 |
| -------- | ----------- | ----------- | ----------- | --------------- | ----------------- | ----------------- | ----------------- | ------------- | ------------------- | ------------------- | -------- | ------------- |
| 0.20748  | 2.59819     | -0.38343    | 0.44554     | 1.74595         | 1.49152           | 0.73736           | 1.20501           | 3.11665       | 1.92157             | 1.06371             | 0.9014   | -1.08664      |
| -0.57273 | -0.01458    | -0.9676     | 1.12731     | 1.12994         | 0.91583           | 1.74987           | 1.40771           | 0.00295       | 1.30803             | 1.43323             | 2.17018  | 0.26108       |
| 2.00579  | 0.82114     | 1.13918     | -0.31983    | -0.11387        | -0.47432          | -0.69233          | -0.68046          | -0.44373      | -0.14386            | -0.33374            | -0.59716 | -1.32241      |
| -1.12509 | -0.64062    | -1.10208    | -0.01466    | 0.1577          | -0.03919          | 0.50711           | 0.58665           | -0.32349      | 0.01909             | 0.91414             | 0.50202  | -0.23667      |
| 0.26806  | 1.00529     | 0.2372      | 2.81636     | 2.06625         | 2.48626           | 1.96              | 2.08655           | 0.79833       | 1.58266             | 1.53257             | 1.52537  | -0.58306      |
| 1.16288  | -0.09593    | 0.07863     | -0.08821    | -0.29008        | -0.3272           | -0.28058          | -0.50495          | -0.11857      | 0.33225             | 0.1058              | -0.15552 | 0.31056       |
| -0.46718 | -0.63014    | -0.08451    | -0.7773     | -0.70072        | -0.70333          | -0.93444          | -0.78236          | -0.44014      | -0.86956            | -0.76595            | -0.86863 | 0.71226       |
| -0.17084 | -0.49788    | 0.75299     | -0.68301    | -0.66747        | -0.61959          | -0.85238          | -0.71677          | -0.4931       | -0.81346            | -1.09258            | -0.89757 | -0.36184      |
| 1.31465  | 0.34748     | 2.35212     | -0.5142     | -0.58062        | -0.56126          | -0.74791          | -0.8104           | -0.46905      | -0.41225            | -0.55553            | -0.82985 | -0.9411       |
| -0.55379 | -0.33481    | -0.3665     | -0.34727    | -0.49522        | -0.38536          | -0.25371          | -0.41222          | -0.37593      | -0.44623            | -0.26262            | -0.41599 | 0.64822       |
| -1.58363 | -0.90193    | -1.27401    | -0.37955    | -0.58472        | -0.49191          | 0.34568           | 0.08939           | -0.35802      | -0.6684             | 0.10947             | 0.03375  | -0.63837      |
| -0.30417 | -0.62571    | -0.641      | -0.42238    | -0.70506        | -0.60335          | -0.44477          | -0.49719          | -0.39384      | -0.69411            | -0.35683            | -0.40152 | 0.94221       |
| -0.18143 | -1.0305     | 0.25902     | -0.8428     | -0.96208        | -0.6881           | -1.09391          | -0.97096          | -0.50206      | -1.11574            | -1.79167            | -0.96645 | 2.29575       |

排序：

| 徐州   | 0.02759  |
| ------ | -------- |
| 南通   | 0.2667   |
| 连云港 | 0.1748   |
| 淮安   | 0.15462  |
| 南京   | 0.03564  |
| 泰州   | -0.02272 |
| 镇江   | -0.02412 |
| 常州   | -0.04044 |
| 宿迁   | -0.06212 |
| 扬州   | -0.07364 |
| 盐城   | -0.07615 |
| 苏州   | -0.1496  |
| 无锡   | -0.21057 |